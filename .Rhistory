#       plot.subtitle = element_text(size = 16, hjust = 0, colour = '#36363d'),
#       plot.caption = element_text(size = 12, hjust = 1, colour = '#36363d'),
#
#       axis.text.x = element_text(size = 10, color = '#5D646F'),
#       axis.title.x = element_text(size = 9, color = '#36363d'),
#       axis.text.y = element_text(size = 12, color = '#5D646F'),
#       axis.title.y = element_text(size = 9, color = '#36363d'),
#       strip.text = element_text(color = '#36363d', size = 16, face = 'bold'),
#
#       plot.background = element_rect(fill = '#fffee3'),
#       plot.margin = margin(80, 20, 100, 40, unit = 'pt'), #t used to be 60
#       strip.background = element_rect(colour='#E3E6EA', fill='#E3E6EA'),
#
#       legend.position = 'top',
#       legend.text  = element_text(family = 'sans', size = 14, colour = '#36363d'),
#       legend.text.align = 0,
#       legend.title = element_text(family = 'sans', size = 14, colour = '#36363d'),
#       legend.box.margin = margin(15, 0, 15, 0, unit = 'pt'),
#       legend.background = element_blank())
ggsave("plot.svg", p, width=11.69, height=8.27, device = "svg", units = "in")
visualization %>%
filter(category_code >= 2000 & category_code < 3000) %>%
ungroup() %>%
group_by(court_name) %>%
summarise(sum_freq = sum(relative_freq_total)) %>%
ggplot(aes(x = court_name, y = sum_freq)) +
geom_point(alpha(0.3))
visualization %>%
filter(category_code >= 2000 & category_code < 3000) %>%
ungroup() %>%
group_by(court_name) %>%
summarise(sum_freq = sum(relative_freq_total)) %>%
ggplot(aes(x = court_name, y = sum_freq)) +
geom_point(aes(alpha(0.3)))
visualization %>%
filter(category_code >= 2000 & category_code < 3000) %>%
ungroup() %>%
group_by(court_name) %>%
summarise(sum_freq = sum(relative_freq_total)) %>%
ggplot(aes(x = court_name, y = sum_freq)) +
geom_point(alpha=0.3)
setwd("/home/ptr_bodnar/Code/R/Data/Texty.org.ua/all_crimes/source files/map/Наді/experiments")
p <- visualization %>%
filter(category_code >= 2000 & category_code < 3000) %>%
ungroup() %>%
group_by(court_name) %>%
summarise(sum_freq = sum(relative_freq_total)) %>%
ggplot(aes(x = court_name, y = sum_freq)) +
geom_point(alpha=0.3) +
theme(axis.line=element_blank(),
axis.text.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position="none",
panel.background=element_blank(),
panel.border=element_blank(),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
plot.background=element_blank())
# theme_minimal(base_family = 'sans') +
# theme(text = element_text(colour = '#36363d'),
#
#       panel.grid.major = element_blank(),
#       panel.grid.minor = element_blank(),
#       #axis.line = element_line(colour = '#36363d', size = 0.469, linetype = 'solid'),
#       #axis.ticks = element_line(colour = '#36363d', size = 0.469, linetype = 'solid'),
#       axis.ticks.length = unit(1, 'pt'),
#       panel.border = element_blank(),
#
#       plot.title = element_text(face = 'bold', size = 20, hjust = 0, colour = '#36363d'),
#       plot.subtitle = element_text(size = 16, hjust = 0, colour = '#36363d'),
#       plot.caption = element_text(size = 12, hjust = 1, colour = '#36363d'),
#
#       axis.text.x = element_text(size = 10, color = '#5D646F'),
#       axis.title.x = element_text(size = 9, color = '#36363d'),
#       axis.text.y = element_text(size = 12, color = '#5D646F'),
#       axis.title.y = element_text(size = 9, color = '#36363d'),
#       strip.text = element_text(color = '#36363d', size = 16, face = 'bold'),
#
#       plot.background = element_rect(fill = '#fffee3'),
#       plot.margin = margin(80, 20, 100, 40, unit = 'pt'), #t used to be 60
#       strip.background = element_rect(colour='#E3E6EA', fill='#E3E6EA'),
#
#       legend.position = 'top',
#       legend.text  = element_text(family = 'sans', size = 14, colour = '#36363d'),
#       legend.text.align = 0,
#       legend.title = element_text(family = 'sans', size = 14, colour = '#36363d'),
#       legend.box.margin = margin(15, 0, 15, 0, unit = 'pt'),
#       legend.background = element_blank())
ggsave("plot.svg", p, width=11.69, height=8.27, device = "svg", units = "in")
knitr::opts_chunk$set(echo = TRUE)
library(date)
library(readr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(RColorBrewer)
library(treemapify)
library(date)
library(readr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(RColorBrewer)
library(treemapify)
сar_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
summarise(value = n()) %>%
View()
сar_registry
View(car_registry)
сar_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
summarise(value = n()) %>%
View()
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer) %>%
summarise(freq = n()) %>%
arrange(desc(freq))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
summarise(value = n()) %>%
View()
df <- car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
summarise(value = n())
require(RJSONIO)
makeList<-function(x){
if(ncol(x)>2){
listSplit<-split(x[-1],x[1],drop=T)
lapply(names(listSplit),function(y){list(name=y,children=makeList(listSplit[[y]]))})
}else{
lapply(seq(nrow(x[1])),function(y){list(name=x[,1][y],Percentage=x[,2][y])})
}
}
require(RJSONIO)
install.packages("RJSONIO")
library(RJSONIO)
makeList<-function(x){
if(ncol(x)>2){
listSplit<-split(x[-1],x[1],drop=T)
lapply(names(listSplit),function(y){list(name=y,children=makeList(listSplit[[y]]))})
}else{
lapply(seq(nrow(x[1])),function(y){list(name=x[,1][y],Percentage=x[,2][y])})
}
}
jsonOut<-toJSON(list(name="treemap",children=makeList(df[-1])))
cat(jsonOut)
jsonOut<-toJSON(list(name="treemap",children=makeList(df[-1])))
jsonOut<-toJSON(list(name="treemap",children=makeList(df[1])))
jsonOut<-toJSON(list(name="treemap",children=makeList(df[2])))
jsonOut<-toJSON(list(name="treemap",children=makeList(df[2])))
makeList<-function(x){
if(ncol(x)>2){
listSplit<-split(x[-1],x[1],drop=T)
lapply(names(listSplit),function(y){
if(as.character(listSplit[[y]][1,1]) > 0){
list(name=y,children=makeList(listSplit[[y]]))
} else {
list(name=y,size=listSplit[[y]][1,2])
}
})
}else{
lapply(seq(nrow(x[1])),function(y){list(name=x[,1][y],size=x[,2][y])})
}
}
jsonOut<-toJSON(list(name="treemap",children=makeList(df[-1])))
df[-1]))
df[-1]))
cat(jsonOut)
jsonOut<-toJSON(list(name="MyData",children=makeList(MyData[-1])))
MyData <- car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
summarise(value = n())
jsonOut<-toJSON(list(name="MyData",children=makeList(MyData[-1])))
knitr::opts_chunk$set(echo = TRUE)
library(date)
library(readr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(RColorBrewer)
library(treemapify)
library(date)
library(readr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(RColorBrewer)
library(treemapify)
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
filter(producer == "RENAULT") %>%
group_by(d_reg, brand) %>%
mutate(freq = n()) %>%
ungroup() %>%
group_by(date = format(d_reg, format="%Y-%m"), brand) %>%
summarise(value = sum(freq)) %>%
ungroup() %>%
spread(brand) %>%
View()
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
filter(producer == "RENAULT") %>%
group_by(d_reg, brand) %>%
mutate(freq = n()) %>%
ungroup() %>%
group_by(date = format(d_reg, format="%Y-%m"), brand) %>%
summarise(value = sum(freq)) %>%
ungroup() %>%
#spread(brand) %>%
View()
#write.csv("data2.csv", row.names = FALSE)
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
filter(producer == "RENAULT") %>%
group_by(d_reg, brand) %>%
mutate(freq = n()) %>%
ungroup() %>%
group_by(date = format(d_reg, format="%Y-%m"), brand) %>%
summarise(value = sum(freq)) %>%
ungroup() %>%
spread(brand, value) %>%
View()
#write.csv("data2.csv", row.names = FALSE)
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
#filter(producer == "RENAULT") %>%
group_by(d_reg, brand) %>%
mutate(freq = n()) %>%
ungroup() %>%
group_by(date = format(d_reg, format="%Y-%m"), brand) %>%
summarise(value = sum(freq)) %>%
ungroup() %>%
spread(brand, value) %>%
View()
#write.csv("data2.csv", row.names = FALSE)
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
#filter(producer == "RENAULT") %>%
group_by(d_reg, brand) %>%
mutate(freq = n()) %>%
ungroup() %>%
group_by(date = format(d_reg, format="%Y-%m"), brand) %>%
summarise(value = sum(freq)) %>%
ungroup() %>%
spread(brand, value) %>%
mutate_all(funs(ifelse(is.na(.), 0, .)))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
filter(producer == "RENAULT") %>%
group_by(d_reg, brand) %>%
mutate(freq = n()) %>%
ungroup() %>%
group_by(date = format(d_reg, format="%Y-%m"), brand) %>%
summarise(value = sum(freq)) %>%
ungroup() %>%
spread(brand, value) %>%
mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
View()
#write.csv("data2.csv", row.names = FALSE)
setwd(Sys.glob("~/Code/Front End/car_register/line plot/"))
setwd(Sys.glob("~/Code/Front End/car_register/line plot/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
filter(producer == "RENAULT") %>%
group_by(d_reg, brand) %>%
mutate(freq = n()) %>%
ungroup() %>%
group_by(date = format(d_reg, format="%Y-%m"), brand) %>%
summarise(value = sum(freq)) %>%
ungroup() %>%
spread(brand, value) %>%
mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
write.csv("data_wide(renault).csv", row.names = FALSE)
setwd(Sys.glob("~/Code/Front End/car_register/line plot/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
#filter(producer == "RENAULT") %>%
group_by(d_reg, brand) %>%
mutate(freq = n()) %>%
ungroup() %>%
group_by(date = format(d_reg, format="%Y-%m"), brand) %>%
summarise(value = sum(freq)) %>%
ungroup() %>%
spread(brand, value) %>%
mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
write.csv("data_wide.csv", row.names = FALSE)
knitr::opts_chunk$set(echo = TRUE)
library(date)
library(readr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(RColorBrewer)
library(treemapify)
library(date)
library(readr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(RColorBrewer)
library(treemapify)
setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest()
setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest()
library("jsonlite", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.4")
setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json()
setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json(path = "~/Code/Front End/car_register/sun/")
setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json(file = "car.json")
setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json(path = "~/Code/Front End/car_register/sun/", file = "car.json")
setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
x <- car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json(x, file = "car.json")
x <- car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest()
write_json(x, file = "car.json")
?write_json
setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json(path = "/home/ptr_bodnar/Code/Front End/car_register", file = "car.json")
setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json(path = "home/ptr_bodnar/Code/Front End/car_register", file = "car.json")
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json(file = "car.json")
setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json(path = "~/Code/Front End/car_register/sun/", file = "car.json")
getwd()
#setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json(path = "/home/ptr_bodnar/Code/Front End/car_register/sun/", file = "car.json")
getwd()
#setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json(path = "/home/ptr_bodnar")
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest()
#setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest()
#setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json(path = "/home/ptr_bodnar/Code/Front End/car_register/sun/", file = "car.json")
?write_json
#setwd(Sys.glob("~/Code/Front End/car_register/sun/"))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
group_by(producer, brand) %>%
nest() %>%
write_json(path = "/home/ptr_bodnar/Code/Front End/car_register/sun/car.json")
knitr::opts_chunk$set(echo = TRUE)
library(date)
library(readr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(RColorBrewer)
library(treemapify)
library(date)
library(readr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(RColorBrewer)
library(treemapify)
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
filter(producer == "RENAULT") %>%
group_by(producer, model) %>%
summarise(freq = n()) %>%
ungroup()
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
filter(producer == "RENAULT") %>%
group_by(producer, model) %>%
summarise(size = n()) %>%
arrange(desc(size))
ungroup()
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
filter(producer == "RENAULT") %>%
group_by(producer, model) %>%
summarise(size = n()) %>%
arrange(desc(size))
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
#filter(producer == "RENAULT") %>%
group_by(producer, model) %>%
summarise(size = n()) %>%
arrange(desc(size))
setwd("~/git/car_cloud")
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
#filter(producer == "RENAULT") %>%
group_by(producer, model) %>%
summarise(size = n()) %>%
arrange(desc(size)) %>%
ungroup() %>%
write.csv("data.csv", row.names = FALSE)
car_registry %>%
filter(kind == "ЛЕГКОВИЙ") %>%
filter(oper_code %in% c(100, 172, 99, 30, 20)) %>%
#filter(producer == "RENAULT") %>%
group_by(producer, model) %>%
summarise(size = n()) %>%
arrange(desc(size)) %>%
ungroup() %>%
summarise(length(unique(producer)))
